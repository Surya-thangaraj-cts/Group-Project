<div class="transaction-container">
  <div class="table-header">
    <h2>Transactional History</h2>
    <div class="export-buttons">
      <button class="export-btn csv-btn" (click)="exportToCSV()">Export CSV</button>
      <button class="export-btn excel-btn" (click)="exportToExcel()">Export Excel</button>
    </div>
  </div>

  <!-- High-Value Filter Tabs -->
  <div class="transaction-tabs" style="margin: 15px 0; display: flex; gap: 10px; border-bottom: 2px solid #e5e7eb; padding-bottom: 0;">
    <button 
      class="tab-button" 
      [class.active]="viewMode === 'all'"
      (click)="toggleHighValueFilter('all')"
      style="padding: 12px 20px; background: none; border: none; cursor: pointer; font-weight: 500; color: #667eea; border-bottom: 3px solid transparent; transition: all 0.3s;">
      All Transactions ({{ transactions.length }})
    </button>
    <button 
      class="tab-button" 
      [class.active]="viewMode === 'highvalue'"
      (click)="toggleHighValueFilter('highvalue')"
      style="padding: 12px 20px; background: none; border: none; cursor: pointer; font-weight: 500; color: #ff6b6b; border-bottom: 3px solid transparent; transition: all 0.3s;">
      High-Value ₹100K+ ({{ getHighValueCount() }})
    </button>
  </div>

  <style>
    .tab-button.active {
      border-bottom-color: #667eea !important;
      color: #667eea !important;
    }
  </style>

  <div class="filters-section">
    <div class="filter-row">
      <div class="filter-group">
        <label>Search (Transaction ID or Account ID)</label>
        <input 
          type="text" 
          [(ngModel)]="searchText" 
          (input)="applyFilters()"
          placeholder="Search by transaction or account..."
          class="filter-input">
      </div>

      <div class="filter-group">
        <label>Status</label>
        <select [(ngModel)]="selectedStatus" (change)="applyFilters()" class="filter-select">
          <option value="">All Status</option>
          <option *ngFor="let status of statuses" [value]="status">{{ status }}</option>
        </select>
      </div>

      <!-- Category filter removed as requested -->

      <div class="filter-group">
        <label>Min Amount (₹)</label>
        <input 
          type="number" 
          [(ngModel)]="minAmount" 
          (input)="applyFilters()"
          placeholder="0"
          class="filter-input">
      </div>

      <div class="filter-group">
        <label>Max Amount (₹)</label>
        <input 
          type="number" 
          [(ngModel)]="maxAmount" 
          (input)="applyFilters()"
          placeholder="∞"
          class="filter-input">
      </div>
    </div>

      <div class="filter-row">
      <div class="filter-group">
        <label>Start Date</label>
        <input 
          type="date" 
          [(ngModel)]="startDate" 
          (change)="applyFilters()"
          class="filter-input">
      </div>

      <div class="filter-group">
        <label>End Date</label>
        <input 
          type="date" 
          [(ngModel)]="endDate" 
          (change)="applyFilters()"
          class="filter-input">
      </div>

      <button class="reset-btn" (click)="resetFilters()">Reset Filters</button>
    </div>
  </div>

  <div class="table-wrapper">
    <table class="data-table">
      <thead>
        <tr>
          <th>Transaction ID</th>
          <th>Account ID</th>
          <th>Type</th>
          <th>Amount</th>
          <th>Date</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let txn of paginatedTransactions" class="table-row">
          <td class="id-cell">{{ txn.id }}</td>
          <td>{{ txn.accountId }}</td>
          <td>{{ txn.type }}</td>
          <td class="amount-cell">{{ formatAmount(txn.amount) }}</td>
          <td>{{ formatDate(txn.date) }}</td>
          <td>
            <span class="status-badge" [ngClass]="getStatusClass(txn.status)">
              {{ txn.status }}
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="pagination-container">
    <div class="pagination-info">
      Showing {{ paginatedTransactions.length > 0 ? (currentPage * pageSize + 1) : 0 }} 
      to {{ Math.min((currentPage + 1) * pageSize, totalItems) }} 
      of {{ totalItems }} transactions
    </div>
    <div class="pagination-controls">
      <button 
        (click)="currentPage = Math.max(0, currentPage - 1)"
        [disabled]="currentPage === 0"
        class="pagination-btn">
        Previous
      </button>
      <span class="page-indicator">Page {{ currentPage + 1 }} of {{ Math.ceil(totalItems / pageSize) || 1 }}</span>
      <button 
        (click)="currentPage = Math.min(Math.ceil(totalItems / pageSize) - 1, currentPage + 1)"
        [disabled]="(currentPage + 1) * pageSize >= totalItems"
        class="pagination-btn">
        Next
      </button>
    </div>
  </div>
</div>